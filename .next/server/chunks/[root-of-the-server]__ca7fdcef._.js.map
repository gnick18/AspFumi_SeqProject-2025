{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///Users/gnickles/Desktop/AspFumi_Site/src/app/api/labs/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { neon } from '@neondatabase/serverless';\n\n// This is the shape of the data that the frontend map/list components expect.\ninterface Lab {\n  id: string;\n  name: string;\n  institution: string;\n  location: string;\n  country: string;\n  lat: number;\n  lng: number;\n}\n\n// Helper function to convert a database row (snake_case) to the frontend format (camelCase) \nfunction dbRowToLab(dbRow: Record<string, string | number | null>): Lab {\n  return {\n    id: String(dbRow.id ?? ''),\n    name: String(dbRow.lab_name ?? ''),\n    institution: String(dbRow.institution ?? ''),\n    location: `${String(dbRow.city ?? '')}${dbRow.state ? ', ' + String(dbRow.state) : ''}, ${String(dbRow.country ?? '')}`,\n    country: String(dbRow.country ?? ''),\n    lat: parseFloat(String(dbRow.latitude ?? '0')),\n    lng: parseFloat(String(dbRow.longitude ?? '0')),\n  };\n}\n\n\nexport async function GET() {\n  try {\n    // 1. Connect to the database\n    const sql = neon(process.env.POSTGRES_URL!);\n\n    // 2. Fetch all lab submissions from the database\n    // We select only the columns needed for the public map to avoid sending extra data.\n    const dbResult = await sql`\n      SELECT id, lab_name, institution, city, state, country, latitude, longitude \n      FROM lab_submissions \n      WHERE latitude IS NOT NULL AND longitude IS NOT NULL;\n    `;\n\n    // 3. Transform the data into the format the frontend expects\n    const labs = dbResult.map(dbRowToLab);\n\n    return NextResponse.json({\n      success: true,\n      labs: labs,\n    });\n\n  } catch (error) {\n    console.error('Error fetching labs for map:', error);\n    return NextResponse.json(\n      { error: 'Internal server error while fetching map data.' },\n      { status: 500 }\n    );\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAaA,6FAA6F;AAC7F,SAAS,WAAW,KAA6C;IAC/D,OAAO;QACL,IAAI,OAAO,MAAM,EAAE,IAAI;QACvB,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,aAAa,OAAO,MAAM,WAAW,IAAI;QACzC,UAAU,GAAG,OAAO,MAAM,IAAI,IAAI,MAAM,MAAM,KAAK,GAAG,OAAO,OAAO,MAAM,KAAK,IAAI,GAAG,EAAE,EAAE,OAAO,MAAM,OAAO,IAAI,KAAK;QACvH,SAAS,OAAO,MAAM,OAAO,IAAI;QACjC,KAAK,WAAW,OAAO,MAAM,QAAQ,IAAI;QACzC,KAAK,WAAW,OAAO,MAAM,SAAS,IAAI;IAC5C;AACF;AAGO,eAAe;IACpB,IAAI;QACF,6BAA6B;QAC7B,MAAM,MAAM,IAAA,gKAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;QAEzC,iDAAiD;QACjD,oFAAoF;QACpF,MAAM,WAAW,MAAM,GAAG,CAAC;;;;IAI3B,CAAC;QAED,6DAA6D;QAC7D,MAAM,OAAO,SAAS,GAAG,CAAC;QAE1B,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;QACR;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAiD,GAC1D;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}